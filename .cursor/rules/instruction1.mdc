---
alwaysApply: false
---
# Строгие правила для работы с проектом CopellaNotepad

## 1. АНАЛИЗ ПРОБЛЕМЫ
- **ВСЕГДА** сначала полностью понимать проблему пользователя
- **НЕ** делать предположений, а изучать код и логику
- Искать **корневую причину**, а не симптомы
- Задавать уточняющие вопросы, если проблема неясна

## 2. КАЧЕСТВО КОДА
- Писать **простой, понятный код** без излишней сложности
- **Тестировать** каждое изменение
- **НЕ ломать** существующую функциональность
- Использовать **существующие паттерны** проекта
- Следовать принципу **KISS** (Keep It Simple, Stupid)

## 3. РАБОТА С ТЕКСТОВЫМ РЕДАКТОРОМ
- Понимать, что это **rich text editor** с `execCommand`
- Учитывать **DOM структуру** и наследование стилей
- Правильно работать с **Selection API** и **Range**
- **НЕ создавать** лишние DOM элементы без необходимости
- Использовать **стандартные браузерные API** для форматирования

## 4. ЛОГИКА МАРКЕРОВ И ФОНОВ
- Маркер применяется к **выделенному тексту**
- Прозрачный фон должен **убирать маркер**, а не создавать новые элементы
- Новый текст должен **наследовать** текущие настройки форматирования
- **НЕ перемещать** курсор без явной необходимости
- Использовать `document.execCommand('backColor', false, color)` для всех случаев

## 5. ПРИНЦИПЫ РАЗРАБОТКИ
- **Минимальные изменения** для решения проблемы
- Сохранение **пользовательского опыта**
- Работа с **существующей архитектурой**
- **НЕ переписывать** код полностью без крайней необходимости
- **Один принцип** - одно изменение

## 6. ОБРАБОТКА ОШИБОК
- При неудаче - **откатиться** к простому решению
- **НЕ усложнять** код для решения простых проблем
- Использовать **проверенные подходы**
- **Тестировать** на реальных сценариях использования

## 7. КОММУНИКАЦИЯ
- **Четко объяснять** что и почему делается
- **Не делать** лишних изменений
- **Спрашивать** уточнения при неясности
- **Признавать ошибки** и исправлять их быстро